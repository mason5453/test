const sliderContainer=document.querySelector(".slider-container"),sliderImages=document.querySelector(".slider-images"),prevBtn=document.querySelector(".prev-btn"),nextBtn=document.querySelector(".next-btn"),indicatorsContainer=document.querySelector(".slider-indicators"),playPauseBtn=document.getElementById("playPauseBtn"),imageDesc=document.getElementById("imageDesc");let autoPlayInterval,isPlaying=!1,slideCount=0,slideWidth=0,currentIndex=0,imageData=[];async function loadImageData(){try{const e=await fetch("demo-image-mapping.json");imageData=await e.json(),slideCount=imageData.length,sliderImages.innerHTML="",imageData.forEach(e=>{const t=document.createElement("div");t.className="slider-image",t.innerHTML=`<img src="demo/${e.imageName}" alt="${e.description}">`,sliderImages.appendChild(t)})}catch(e){console.error("加载JSON失败：",e),alert("图片描述加载失败，请检查JSON文件路径！"),slideCount=0}}function initIndicators(){indicatorsContainer.innerHTML="";for(let e=0;e<slideCount;e++){const t=document.createElement("div");t.className="indicator "+(0===e?"active":""),t.setAttribute("data-index",e),t.addEventListener("click",()=>{currentIndex=e,updateSlider()}),indicatorsContainer.appendChild(t)}}function updateSlider(){0!==slideCount&&(sliderImages.style.transform=`translateX(-${currentIndex*slideWidth}px)`,document.querySelectorAll(".indicator").forEach((e,t)=>{e.classList.toggle("active",t===currentIndex)}),imageDesc.textContent=imageData[currentIndex].description)}function goToNextSlide(){currentIndex=(currentIndex+1)%slideCount,updateSlider()}function goToPrevSlide(){currentIndex=(currentIndex-1+slideCount)%slideCount,updateSlider()}function startAutoPlay(e=3e3){slideCount<=1||(autoPlayInterval=setInterval(goToNextSlide,e),isPlaying=!0,playPauseBtn.textContent="暂停")}function stopAutoPlay(){clearInterval(autoPlayInterval),isPlaying=!1,playPauseBtn.textContent="播放"}function togglePlayPause(){slideCount<=1?alert("只有1张图片，无需自动播放！"):isPlaying?stopAutoPlay():startAutoPlay()}async function initSlider(){if(await loadImageData(),slideCount<=1)return prevBtn.disabled=!0,nextBtn.disabled=!0,playPauseBtn.disabled=!0,void(playPauseBtn.textContent="无播放");slideWidth=document.querySelector(".slider-images-wrapper").clientWidth,initIndicators(),updateSlider(),prevBtn.addEventListener("click",goToPrevSlide),nextBtn.addEventListener("click",goToNextSlide),playPauseBtn.addEventListener("click",togglePlayPause),sliderContainer.addEventListener("mouseenter",()=>{isPlaying&&stopAutoPlay()}),sliderContainer.addEventListener("mouseleave",()=>{isPlaying&&startAutoPlay()}),window.addEventListener("resize",()=>{location.reload()})}initSlider();